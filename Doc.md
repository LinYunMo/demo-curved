在固定背后视角的跑酷游戏中，玩家面对的始终是前方布满障碍的赛道，除去有趣的障碍设计可以一直吸引玩家的注意外，许多游戏还会添加一些视觉效果使游戏看起来画面更有趣，比如今天我们要分享的这款《猪猪侠：极速狂飙》就采用了曲面的效果使得赛道看起来更多变，也更有立体感和纵深感。
那么，这样的效果在Cocos Creator 3D 中是如何实现的呢？
首先我们需要明白一点，这样的曲面效果，实际上影响的只是显示的效果，与其他任何的系统是无关的，那么想要达成以上目的，使用 shader 实现是再合适不过的了。
从需求来看，要求的曲面效果并不涉及到颜色的变化和处理，只是单纯的对模型顶点位置进行操作，所以需要处理的就只有顶点着色器部分，而并不涉及片段着色器。
明确了是对顶点位置进行操作，那么我们将摄像机所在的点定为原点。由于我们的摄像机为固定在人物背后的，且赛道始终保持向 Z 轴负方向延伸，所以可以将模型与摄像机的 Z 轴方向的距离看作函数的输入值，想要得到曲面的效果，模型的点的变化规律如下：
- 距离原点越远的点产生的偏置值越大（函数在区间内为增函数）
- 距离原点越远的点偏置的变化速度越快（函数的导数为一次函数）
由上述两条规律不难得出，二次函数的变化规律与我们想要实现的曲面效果的规律契合，所以我们的顶点着色器的运算为一个关于顶点位置 Z 值的二次函数运算。
在观察空间中进行处理（经过matworld到世界空间在经过matView到观察空间下）（因为实际上的变化就是相对于摄像机的）